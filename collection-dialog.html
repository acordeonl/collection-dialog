<imports >
    <link rel="import" href="../polymer/polymer.html">
    <link rel="import" href="../iron-ajax/iron-ajax.html" async>
    <link rel="import" href="../paper-spinner/paper-spinner-lite.html" async>
    <link rel="import" href="../paper-dialog/paper-dialog.html">
    <link rel="import" href="../paper-ripple/paper-ripple.html" async>
    <link rel="import" href="../paper-icon-button/paper-icon-button.html">
    <link rel="import" href="../iron-icon/iron-icon.html">
    <link rel="import" href="../iron-icons/iron-icons.html">
    <link rel="import" href="../iron-icons/hardware-icons.html">
    <link rel="import" href="../iron-icons/social-icons.html">
    <link rel="import" href="../iron-icons/image-icons.html">
    <link rel="import" href="../iron-icons/av-icons.html">
    <link rel="import" href="../iron-icons/communication-icons.html">
    <link rel="import" href="../ajax-manager/ajax-manager.html">
</imports>
<!--

Shows drop down menu (works on chrome)

### Usage
The list displayed in the drop down menu can be set as an attribute.

    <drop-menu list-items='["first" ,"second"]'></drop-menu>

For an overlayed drop menu:

    <drop-menu overlay-menu list-items='["first" ,"second"]'></drop-menu>

### Styling
 Custom property | Description | Default
----------------|-------------|----------
`--item-background-color` | List item backround color | `#f1ecef`
`--item-color` | List item color used for fonts | `#302f31`
`--close-color` | Icon button hover color | `4775D1`
`--content-background` | Drop menu's background color | `white`
`--close-color` | Icon button hover color | `4775D1`
`--icon-button` | Mixin applied the icon button | `{}`

@demo demo/drop-menu-demo.html
-->
<dom-module id="collection-dialog">
    <template>
        <styles>
            <style dialog title>
            paper-icon-button{
                margin-left:-10px ;
                margin-top: -20px ;
                margin-right: 12px ;
                color:var(--content-color2) ;
                border-radius: 100% ;
            }
            paper-icon-button:hover{
                color:var(--close-color) ;
            }
            [dialog-title] {
                margin-bottom: 30px ;
                @apply(--layout-horizontal);
                @apply(--layout-center);
                color: var(--content-color2);
            }
            [title]{
                width: 100% ;
                color:var(--content-color2) ;
                @apply(--layout-center-justified);
                @apply(--layout-horizontal);
            }
            [exit-button-invisible]{
                visibility: hidden;
            }
            </style>
            <style dialog-content>
                [section-title] {
                    margin-bottom: 20px;
                    border-radius: 5px ;
                    opacity: 0.94;
                    text-align:justified ;
                    background-color: var(--close-color2) ;
                    color:var(--content-background) ;
                    position: relative;
                    padding-right:20px ;
                    padding-left:20px ;
                    padding-top: 5px ;
                    padding-bottom: 5px ;
                }
                [section-title]:hover {
                    cursor: pointer ;
                    opacity: 1;
                }
            </style>
            <style>
                p {
                    width: 100% ;
                    word-wrap: break-word;
                }
                paper-dialog {
                    top:10vh;
                    font-size: 22px;
                    font-weight: 300;
                    width: 500px;
                    height: 400px;
                    overflow: auto;
                    border-radius: 10px;
                    background-color: var(--content-background);
                }
                [spinner] {
                    height: 80%;
                    width: 100%;
                    margin-top: 100px;
                    @apply(--layout-horizontal);
                    @apply(--layout-center-justified);
                    @apply(--layout-center);
                }
            </style>
        </styles>
        <ajax-manager response={{collections}} request="collections" loading={{loading}}></ajax-manager>
        <paper-dialog entry-animation="scale-up-animation" exit-animation="fade-out-animation" id="dialog" with-backdrop>
            <div wrapper>
                <div dialog-title>
                    <div exit-button>
                        <paper-icon-button on-click="close" icon="close"></paper-icon-button>
                    </div>
                    <div title>
                        Agregar a colecci√≤n
                    </div>
                    <div exit-button-invisible>
                        <paper-icon-button on-click="close" icon="close"></paper-icon-button>
                    </div>
                </div>
                <template id="domRepeat" is="dom-repeat" items="{{collections.list}}" as="collection">
                    <div on-click="_addToCollection" id="{{collection.id}}" collection-url={{collection.url}} collection-name={{collection.name}} section-title>
                        <div>
                            <p>{{collection.name}}</p>
                        </div>
                        <paper-ripple></paper-ripple>
                    </div>
                </template>
                <template is="dom-if" if="[[loading]]">
                    <div spinner>
                        <paper-spinner-lite active></paper-spinner-lite>
                    </div>
                </template>
            </div>
        </paper-dialog>
    </template>
    <script>
        Polymer({
            is: "collection-dialog",
            observers: [],
            behaviors: [],
            listeners: {},
            properties: {
                collections:{
                    observer:'_updateList'
                }
            },
            _updateList: function(){
                this.$.domRepeat.render() ;
            },
            _addToCollection: function (e) {
                this.fire('select-collection' ,{id:e.currentTarget.id,name:this.$$('#'+e.currentTarget.id).collectionName}) ;
                this.close() ;
            },
            open: function () {
                var other=this.collections ;
                this.collections=[] ;
                this.async(function(){
                    this.collections=other ;
                },100) ;
                this.$.dialog.open();
            },
            close: function(){
                this.$.dialog.close() ;
            }
        });
    </script>
</dom-module>
